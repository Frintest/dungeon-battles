"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[908],{370:(t,s,e)=>{e.r(s),e.d(s,{default:()=>l});var h=e(18);const i="vpOlVWGHFn2ZjZJccR2X";var a=e(541);e.p;class n{constructor(t,s,e,h,i){this.angle=t,this.x=h+(20*Math.cos(this.angle)-5*Math.sin(this.angle)),this.y=i+(20*Math.sin(this.angle)+5*Math.cos(this.angle)),this.speed=5,this.width=20,this.height=4,this.canvas=s,this.ctx=e}updateCoords=()=>{this.x+=this.speed*Math.cos(this.angle),this.y+=this.speed*Math.sin(this.angle)};draw=()=>{this.ctx.save(),this.ctx.translate(this.x,this.y),this.ctx.rotate(this.angle),this.ctx.fillStyle="#ffffff",this.ctx.fillRect(0,-this.height/2,this.width,this.height),this.ctx.restore()};isOffScreen=()=>this.x<0||this.x>this.canvas.width||this.y<0||this.y>this.canvas.height;getIsOffScreen=()=>this.isOffScreen()}class o{constructor(t,s,e,h,i,a,n){this.name=t,this.damageCount=s,this.x=e,this.y=h,this.angle=i,this.width=32,this.height=20,this.canvas=a,this.ctx=n,this.bullets=[]}drawWeapon=()=>{const t=new Image;t.src="./img/luger.png",t.onload=()=>{this.ctx.save(),this.ctx.translate(this.x,this.y),this.ctx.rotate(this.angle),this.ctx.drawImage(t,0,0,this.width,this.height),this.ctx.restore()}};updateCoords=(t,s)=>{this.x=t,this.y=s};updateAngleWeapon=t=>{this.angle=t};createBullet=()=>{const t=new n(this.angle,this.canvas,this.ctx,this.x,this.y);this.bullets.push(t)};removeBullet=()=>{};shot=()=>{this.bullets.forEach((t=>{t.getIsOffScreen()||(t.updateCoords(),t.draw())}))}}class d{constructor(t,s,e,h,i,a,n,d){this.name=t,this.lifeCount=s,this.avatarSrc=e,this.x=i,this.y=a,this.width=40,this.height=40,this.angle=0,this.speed=5,this.dx=0,this.dy=0,this.weaponName=h,this.canvas=n,this.ctx=d,this.isShot=!1,this.weapon=new o(this.weaponName,0,this.x,this.y,this.angle,this.canvas,this.ctx)}drawHero=()=>{const t=new Image;t.src=`./img/${this.avatarSrc}`,t.onload=()=>{this.ctx.save(),this.ctx.translate(this.x,this.y),this.ctx.rotate(this.angle),this.ctx.drawImage(t,-this.width/2,-this.height/2,this.width,this.height),this.ctx.restore()}};updateCoords=()=>{this.x+=this.dx,this.y+=this.dy,this.x<this.width/2&&(this.x=this.width/2),this.x>this.canvas.width-this.width/2&&(this.x=this.canvas.width-this.width/2),this.y<this.height/2&&(this.y=this.height/2),this.y>this.canvas.height-this.height/2&&(this.y=this.canvas.height-this.height/2)};death=()=>{this.lifeCount=0};drawWeapon=()=>{this.weapon.drawWeapon()};updateCoordsWeapon=()=>{this.weapon.updateCoords(this.x,this.y)};updateAngleWeapon=()=>{this.weapon.updateAngleWeapon(this.angle)};createBullet=()=>{this.weapon.createBullet()};shot=()=>{this.weapon.shot()};getIsShot=()=>this.isShot}const c={w:!1,a:!1,s:!1,d:!1,e:!1};class r extends d{updateDirection=()=>{this.dx=0,this.dy=0,c.w&&(this.dy=-this.speed),c.a&&(this.dx=-this.speed),c.s&&(this.dy=this.speed),c.d&&(this.dx=this.speed)};handleKeyDown=t=>{"w"===t.key&&(c.w=!0),"a"===t.key&&(c.a=!0),"s"===t.key&&(c.s=!0),"d"===t.key&&(c.d=!0),this.updateDirection()};handleKeyUp=t=>{"w"===t.key&&(c.w=!1),"a"===t.key&&(c.a=!1),"s"===t.key&&(c.s=!1),"d"===t.key&&(c.d=!1),this.updateDirection()};handleMouseMove=t=>{const s=this.canvas.getBoundingClientRect(),e=t.clientX-s.left,h=t.clientY-s.top;this.angle=Math.atan2(h-this.y,e-this.x)};handleShotKey=t=>{"e"===t.key&&(this.isShot=!0,this.createBullet())};handleMoveKeys=()=>{window.addEventListener("keydown",(t=>{this.handleKeyDown(t),this.handleShotKey(t)})),window.addEventListener("keyup",this.handleKeyUp),window.addEventListener("mousemove",this.handleMouseMove)}}e.p,e.p;const l=(0,e(319).Ng)((t=>({heroes:t.TeamReducer.heroes})),null)((t=>{h.useEffect((()=>{e()}));const s=h.useRef(null),e=()=>{const t=s.current.getContext("2d"),e=new r("Название",10,"offer.png","Кагорушка",100,100,s.current,t);e.handleMoveKeys();const h=()=>{(()=>{const e=new Image;e.src="./img/fill.jpg",e.onload=()=>{t.drawImage(e,0,0,s.current.width,s.current.height)}})(),e.drawHero(),e.updateCoords(),e.updateCoordsWeapon(),e.updateAngleWeapon(),e.drawWeapon(),e.getIsShot()&&e.shot()},i=()=>{h(),requestAnimationFrame(i)};i()};return h.createElement("div",{className:i},h.createElement(a.m,null,h.createElement("canvas",{ref:s,width:1200,height:800})))}))}}]);